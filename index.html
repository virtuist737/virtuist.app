<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtuist</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
    <link rel="icon" href="assets/favicon.ico">
    <link rel="manifest" href="assets/site.webmanifest">
</head>
<body>
    <div class="header">
        <div class="logo-container" style="cursor: pointer;" onclick="showVirtues()">
            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="50pt" height="50pt" viewBox="0 0 243.000000 252.000000" preserveAspectRatio="xMidYMid meet">
                <g transform="translate(0.000000,252.000000) scale(0.100000,-0.100000)" fill="#FFFFFF" stroke="none">
                    <path d="M450 2165 c-81 -37 -141 -139 -124 -212 3 -15 103 -320 220 -678 145
                        -439 224 -665 245 -696 107 -168 318 -240 515 -177 68 21 68 21 36 29 -40 8
                        -87 50 -112 99 -9 19 -126 364 -260 765 -134 402 -253 751 -267 777 -32 65
                        -87 101 -161 105 -37 2 -70 -2 -92 -12z"/>
                    <path d="M1715 2163 c-43 -23 -74 -53 -95 -93 -10 -19 -111 -320 -226 -668
                        l-208 -632 28 -88 c55 -168 88 -212 160 -212 68 0 116 20 143 61 14 21 123
                        336 250 721 251 760 249 750 197 835 -51 83 -169 119 -249 76z"/>
                </g>
            </svg>
            <h1 class="app-title">Virtuist</h1>
        </div>
        <button id="infoButton" class="info-button">i</button>
    </div>

    <div class="mode-selector">
        <button class="mode-button active" onclick="switchMode('practice')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <circle cx="12" cy="12" r="6"/>
                <circle cx="12" cy="12" r="2"/>
            </svg>
            Practice
        </button>
        <button class="mode-button" onclick="switchMode('study')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
            </svg>
            Study
        </button>
    </div>

    <div id="selectedVirtueContainer" class="selected-virtue-container">
        <button class="back-arrow" onclick="showVirtues()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
        </button>
        <div id="selectedVirtue" class="selected-virtue"></div>
    </div>
    
    <div class="virtue-grid" id="virtueGrid"></div>

    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>About Virtuist</h2>
        </br>
            <h3>What are virtues?</h3>
        </br>
            <p>Virtues are universal behavioral instruments that elicit lasting peace and joy.</p>
            <p>Just as musical instruments---like the piano---can elicit emotional experiences, virtues---like empathy---are behavioral instruments that when wielded skillfully can elicit lasting emotional experiences of peace and/or joy in oneself and others.</p>
        </br>
            <h3>Why does this app exist?</h3>
        </br>
            <p>I'm building Virtuist in hopes that it will enable and inspire more people to practice virtues, thereby reducing suffering and increasing peace and joy.</p>
            <p>I have observed that while both religious and secular organizations succeed at helping people practice some primary virtues, they fail with other primary virtues. Most of them tend to drive division and hatred.</p>
            <p>This app is my attempt to pave a better path that we can all walk together, helping each other practice virtues that will bring us all greater peace and joy.</p>
        </br>
            <h3>What are the plans for this app?</h3>
        </br>
            <p>My vision is to build an app like Duolingo, but instead of helping people study and practice languages it will help people study and practice virtues.</p>
            <p>I plan to first focus on the app itself, building it into a gamified experience with a robust library of resources.</p>
            <p>Then I plan to try to enable Virtuists to connect with each other and build local communities on a common foundation of virtues.</p>
        </br>
            <h3>How can you help?</h3>
        </br>
            <ol>
                <li>Share Virtuist with your family and friends, inviting them to practice and study virtues with you.</li>
                <li>Email me at [coming soon] to share your ideas for app features, practice exercises and virtue stories.</li>
                <li>Donate at [coming soon] so I can invest more time and money into building Virtuist.</li>
            </ol>
        </br>
            <p>Thank you!</p>
        </div>
    </div>

    <div class="content-container" id="practiceContainer">
        <div class="practice-container">
            <button class="nav-arrow left" onclick="previousPractice()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M15 18l-6-6 6-6"/>
                </svg>
            </button>
            <div class="practice-text" id="practiceText"></div>
            <button class="nav-arrow right" onclick="nextPractice()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 18l6-6-6-6"/>
                </svg>
            </button>
        </div>
    </div>

    <div class="content-container" id="studyContainer">
        <div class="study-text">
            <div class="study-section">
                <h3>Definition</h3>
                <div id="studyDefinition"></div>
            </div>
            <div class="study-section">
                <h3>Example Story</h3>
                <div class="practice-container">
                    <button class="nav-arrow left" onclick="previousStory()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M15 18l-6-6 6-6"/>
                        </svg>
                    </button>
                    <div class="story-text" id="studyStory"></div>
                    <button class="nav-arrow right" onclick="nextStory()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 18l6-6-6-6"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize empty objects to store data
        let virtueData = {};
        let virtues = [];
        let virtueColors = {};
        let virtuePractices = {};
        let virtueStories = {};
        let virtueDefinitions = {};
        let currentMode = 'practice';
        let currentVirtue = null;
        let currentPracticeIndex = 0;
        let currentStoryIndex = 0;

        // Function to load data from JSON file
        async function loadVirtuesData() {
            try {
                const response = await fetch('virtues-data.json');
                virtueData = await response.json();
                
                // Populate our variables from the JSON data
                virtues = virtueData.virtues;
                virtueColors = virtueData.virtueColors;
                virtuePractices = virtueData.virtuePractices;
                virtueStories = virtueData.virtueStories;
                virtueDefinitions = virtueData.virtueDefinitions;

                // Initialize the app after data is loaded
                initializeApp();
            } catch (error) {
                console.error('Error loading virtues data:', error);
            }
        }

        function initializeApp() {
            const virtueGrid = document.getElementById('virtueGrid');
            virtues.forEach(virtue => {
                const button = document.createElement('button');
                button.className = 'virtue-button';
                button.style.backgroundColor = virtueColors[virtue];
                button.onclick = () => selectVirtue(virtue);
                button.textContent = virtue.charAt(0).toUpperCase() + virtue.slice(1);
                virtueGrid.appendChild(button);
            });
        }

        function switchMode(mode) {
            currentMode = mode;
            
            // Reset all buttons to transparent and remove active class
            document.querySelectorAll('.mode-button').forEach(btn => {
                btn.classList.remove('active');
                btn.style.backgroundColor = 'transparent';
            });
            
            // Set the clicked button as active
            event.currentTarget.classList.add('active');
            
            // Set the active button's color based on whether a virtue is selected
            const activeButton = document.querySelector('.mode-button.active');
            activeButton.style.backgroundColor = currentVirtue ? 'var(--primary-color)' : '#383838';
            
            if (currentVirtue) {
                showContent();
            }
        }

        function selectVirtue(virtue) {
            currentVirtue = virtue;
            currentPracticeIndex = 0;
            currentStoryIndex = 0;
            
            document.documentElement.style.setProperty('--primary-color', virtueColors[virtue]);
            const selectedVirtueElement = document.getElementById('selectedVirtue');
            selectedVirtueElement.textContent = virtue.charAt(0).toUpperCase() + virtue.slice(1);
            document.getElementById('selectedVirtueContainer').style.display = 'block';
            
            // Update active mode button and info button colors
            document.querySelector('.mode-button.active').style.backgroundColor = 'var(--primary-color)';
            document.getElementById('infoButton').style.backgroundColor = 'var(--primary-color)';
            
            showContent();
        }

        function showContent() {
            document.getElementById('virtueGrid').style.display = 'none';
            const practiceContainer = document.getElementById('practiceContainer');
            const studyContainer = document.getElementById('studyContainer');
            
            practiceContainer.style.display = currentMode === 'practice' ? 'block' : 'none';
            studyContainer.style.display = currentMode === 'study' ? 'block' : 'none';
            
            if (currentMode === 'practice') {
                showPractice();
            } else {
                showStudyContent();
            }
        }

        function showPractice() {
            const practiceArray = virtuePractices[currentVirtue];
            document.getElementById('practiceText').textContent = practiceArray[currentPracticeIndex];
        }

        function nextPractice() {
            const practiceArray = virtuePractices[currentVirtue];
            currentPracticeIndex = (currentPracticeIndex + 1) % practiceArray.length;
            showPractice();
        }

        function previousPractice() {
            const practiceArray = virtuePractices[currentVirtue];
            currentPracticeIndex = (currentPracticeIndex - 1 + practiceArray.length) % practiceArray.length;
            showPractice();
        }

        function showVirtues() {
            document.getElementById('virtueGrid').style.display = 'grid';
            document.getElementById('practiceContainer').style.display = 'none';
            document.getElementById('studyContainer').style.display = 'none';
            document.getElementById('selectedVirtueContainer').style.display = 'none';
            
            // Reset mode button and info button to default gray
            document.querySelector('.mode-button.active').style.backgroundColor = '#383838';
            document.getElementById('infoButton').style.backgroundColor = '#383838';
        }

        function showStudyContent() {
            document.getElementById('studyDefinition').textContent = virtueDefinitions[currentVirtue];
            showStory();
        }

        function showStory() {
            const stories = virtueStories[currentVirtue];
            document.getElementById('studyStory').textContent = stories[currentStoryIndex];
        }

        function nextStory() {
            const stories = virtueStories[currentVirtue];
            currentStoryIndex = (currentStoryIndex + 1) % stories.length;
            showStory();
        }

        function previousStory() {
            const stories = virtueStories[currentVirtue];
            currentStoryIndex = (currentStoryIndex - 1 + stories.length) % stories.length;
            showStory();
        }

        // Modal handling
        const modal = document.getElementById("infoModal");
        const closeButton = document.getElementsByClassName("close")[0];

        document.getElementById("infoButton").onclick = function() {
            modal.style.display = "block";
        }

        closeButton.onclick = function() {
            modal.style.display = "none";
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        // Load the data when the page loads
        loadVirtuesData();
    </script>
</body>
</html>